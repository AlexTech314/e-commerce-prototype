{"ast":null,"code":"import _objectSpread from\"C:/Users/alest/personal_projects/UnSad_Real/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useEffect}from'react';import{useDispatch,useSelector}from'react-redux';import{Link}from'react-router-dom';import{createOrder}from'../actions/orderActions';import CheckoutSteps from'../components/CheckoutSteps';import{ORDER_CREATE_RESET}from'../constants/orderConstants';import LoadingBox from'../components/LoadingBox';import MessageBox from'../components/MessageBox';export default function PlaceOrderScreen(props){var cart=useSelector(function(state){return state.cart;});if(!cart.paymentMethod){props.history.push('/payment');}var orderCreate=useSelector(function(state){return state.orderCreate;});var loading=orderCreate.loading,success=orderCreate.success,error=orderCreate.error,order=orderCreate.order;var toPrice=function toPrice(num){return Number(num.toFixed(2));};// 5.123 => \"5.12\" => 5.12\ncart.itemsPrice=toPrice(cart.cartItems.reduce(function(a,c){return a+c.qty*c.price;},0));cart.shippingPrice=cart.itemsPrice>100?toPrice(0):toPrice(10);cart.taxPrice=toPrice(0.15*cart.itemsPrice);cart.totalPrice=cart.itemsPrice+cart.shippingPrice+cart.taxPrice;var dispatch=useDispatch();var placeOrderHandler=function placeOrderHandler(){// TODO: dispatch place order action\ndispatch(createOrder(_objectSpread(_objectSpread({},cart),{},{orderItems:cart.cartItems})));};useEffect(function(){// console.log(cart.cartItems);\nif(success){props.history.push(\"/order/\".concat(order._id));dispatch({type:ORDER_CREATE_RESET});}},[dispatch,order,props.history,success]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CheckoutSteps,{step1:true,step2:true,step3:true,step4:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"row top\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-2\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card card-body\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Shipping\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Name:\"}),\" \",cart.shippingAddress.fullName,\" \",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"Address: \"}),\" \",cart.shippingAddress.address,\",\",cart.shippingAddress.city,\", \",cart.shippingAddress.postalCode,\",\",cart.shippingAddress.country]})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card card-body\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Payment\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Method:\"}),\" \",cart.paymentMethod]})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card card-body\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Order Items\"}),/*#__PURE__*/_jsx(\"ul\",{children:cart.cartItems.map(function(item){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"min-30\",children:/*#__PURE__*/_jsx(\"img\",{src:item.image,alt:item.name,className:\"small\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"min-30\",children:/*#__PURE__*/_jsx(Link,{to:\"/product/\".concat(item.product),children:item.name})}),/*#__PURE__*/_jsx(\"div\",{className:\"min-30\",children:/*#__PURE__*/_jsx(\"p\",{children:item.size})}),/*#__PURE__*/_jsxs(\"div\",{className:\"min-30\",children:[item.qty,\" x $\",item.price,\" = $\",item.qty*item.price]})]})},item.product);})})]})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-1\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card card-body\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"h2\",{children:\"Order Summary\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"Items\"}),/*#__PURE__*/_jsxs(\"div\",{children:[\"$\",cart.itemsPrice.toFixed(2)]})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"Shipping\"}),/*#__PURE__*/_jsxs(\"div\",{children:[\"$\",cart.shippingPrice.toFixed(2)]})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"Tax\"}),/*#__PURE__*/_jsxs(\"div\",{children:[\"$\",cart.taxPrice.toFixed(2)]})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\" Order Total\"})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"strong\",{children:[\"$\",cart.totalPrice.toFixed(2)]})})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:placeOrderHandler,className:\"primary block\",disabled:cart.cartItems.length===0,children:\"Place Order\"})}),loading&&/*#__PURE__*/_jsx(LoadingBox,{}),error&&/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:error})]})})})]})]});}","map":{"version":3,"sources":["C:/Users/alest/personal_projects/UnSad_Real/frontend/src/screens/PlaceOrderScreen.js"],"names":["React","useEffect","useDispatch","useSelector","Link","createOrder","CheckoutSteps","ORDER_CREATE_RESET","LoadingBox","MessageBox","PlaceOrderScreen","props","cart","state","paymentMethod","history","push","orderCreate","loading","success","error","order","toPrice","num","Number","toFixed","itemsPrice","cartItems","reduce","a","c","qty","price","shippingPrice","taxPrice","totalPrice","dispatch","placeOrderHandler","orderItems","_id","type","shippingAddress","fullName","address","city","postalCode","country","map","item","image","name","product","size","length"],"mappings":"8NAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,aAAzC,CACA,OAASC,IAAT,KAAqB,kBAArB,CACA,OAASC,WAAT,KAA4B,yBAA5B,CACA,MAAOC,CAAAA,aAAP,KAA0B,6BAA1B,CACA,OAASC,kBAAT,KAAmC,6BAAnC,CACA,MAAOC,CAAAA,UAAP,KAAuB,0BAAvB,CACA,MAAOC,CAAAA,UAAP,KAAuB,0BAAvB,CAEA,cAAe,SAASC,CAAAA,gBAAT,CAA0BC,KAA1B,CAAiC,CAC9C,GAAMC,CAAAA,IAAI,CAAGT,WAAW,CAAC,SAACU,KAAD,QAAWA,CAAAA,KAAK,CAACD,IAAjB,EAAD,CAAxB,CACA,GAAI,CAACA,IAAI,CAACE,aAAV,CAAyB,CACvBH,KAAK,CAACI,OAAN,CAAcC,IAAd,CAAmB,UAAnB,EACD,CACD,GAAMC,CAAAA,WAAW,CAAGd,WAAW,CAAC,SAACU,KAAD,QAAWA,CAAAA,KAAK,CAACI,WAAjB,EAAD,CAA/B,CAL8C,GAMtCC,CAAAA,OANsC,CAMHD,WANG,CAMtCC,OANsC,CAM7BC,OAN6B,CAMHF,WANG,CAM7BE,OAN6B,CAMpBC,KANoB,CAMHH,WANG,CAMpBG,KANoB,CAMbC,KANa,CAMHJ,WANG,CAMbI,KANa,CAO9C,GAAMC,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,CAACC,GAAD,QAASC,CAAAA,MAAM,CAACD,GAAG,CAACE,OAAJ,CAAY,CAAZ,CAAD,CAAf,EAAhB,CAAiD;AACjDb,IAAI,CAACc,UAAL,CAAkBJ,OAAO,CACvBV,IAAI,CAACe,SAAL,CAAeC,MAAf,CAAsB,SAACC,CAAD,CAAIC,CAAJ,QAAUD,CAAAA,CAAC,CAAGC,CAAC,CAACC,GAAF,CAAQD,CAAC,CAACE,KAAxB,EAAtB,CAAqD,CAArD,CADuB,CAAzB,CAGApB,IAAI,CAACqB,aAAL,CAAqBrB,IAAI,CAACc,UAAL,CAAkB,GAAlB,CAAwBJ,OAAO,CAAC,CAAD,CAA/B,CAAqCA,OAAO,CAAC,EAAD,CAAjE,CACAV,IAAI,CAACsB,QAAL,CAAgBZ,OAAO,CAAC,KAAOV,IAAI,CAACc,UAAb,CAAvB,CACAd,IAAI,CAACuB,UAAL,CAAkBvB,IAAI,CAACc,UAAL,CAAkBd,IAAI,CAACqB,aAAvB,CAAuCrB,IAAI,CAACsB,QAA9D,CACA,GAAME,CAAAA,QAAQ,CAAGlC,WAAW,EAA5B,CACA,GAAMmC,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,EAAM,CAC9B;AAEAD,QAAQ,CAAC/B,WAAW,gCAAMO,IAAN,MAAY0B,UAAU,CAAE1B,IAAI,CAACe,SAA7B,GAAZ,CAAR,CACD,CAJD,CAKA1B,SAAS,CAAC,UAAM,CACd;AACA,GAAIkB,OAAJ,CAAa,CACXR,KAAK,CAACI,OAAN,CAAcC,IAAd,kBAA6BK,KAAK,CAACkB,GAAnC,GACAH,QAAQ,CAAC,CAAEI,IAAI,CAAEjC,kBAAR,CAAD,CAAR,CACD,CACF,CANQ,CAMN,CAAC6B,QAAD,CAAWf,KAAX,CAAkBV,KAAK,CAACI,OAAxB,CAAiCI,OAAjC,CANM,CAAT,CAOA,mBACE,oCACE,KAAC,aAAD,EAAe,KAAK,KAApB,CAAqB,KAAK,KAA1B,CAA2B,KAAK,KAAhC,CAAiC,KAAK,KAAtC,EADF,cAEE,aAAK,SAAS,CAAC,SAAf,wBACE,YAAK,SAAS,CAAC,OAAf,uBACE,mCACE,iCACE,aAAK,SAAS,CAAC,gBAAf,wBACE,gCADF,cAEE,kCACE,iCADF,KAC0BP,IAAI,CAAC6B,eAAL,CAAqBC,QAD/C,kBACyD,aADzD,cAEE,qCAFF,KAE8B9B,IAAI,CAAC6B,eAAL,CAAqBE,OAFnD,KAGG/B,IAAI,CAAC6B,eAAL,CAAqBG,IAHxB,MAGgChC,IAAI,CAAC6B,eAAL,CAAqBI,UAHrD,KAIIjC,IAAI,CAAC6B,eAAL,CAAqBK,OAJzB,GAFF,GADF,EADF,cAYE,iCACE,aAAK,SAAS,CAAC,gBAAf,wBACE,+BADF,cAEE,kCACE,mCADF,KAC4BlC,IAAI,CAACE,aADjC,GAFF,GADF,EAZF,cAoBE,iCACE,aAAK,SAAS,CAAC,gBAAf,wBACE,mCADF,cAEE,oBACGF,IAAI,CAACe,SAAL,CAAeoB,GAAf,CAAmB,SAACC,IAAD,qBAClB,iCACE,aAAK,SAAS,CAAC,KAAf,wBACE,YAAK,SAAS,CAAC,QAAf,uBACE,YACE,GAAG,CAAEA,IAAI,CAACC,KADZ,CAEE,GAAG,CAAED,IAAI,CAACE,IAFZ,CAGE,SAAS,CAAC,OAHZ,EADF,EADF,cAQE,YAAK,SAAS,CAAC,QAAf,uBACE,KAAC,IAAD,EAAM,EAAE,oBAAcF,IAAI,CAACG,OAAnB,CAAR,UACGH,IAAI,CAACE,IADR,EADF,EARF,cAaE,YAAK,SAAS,CAAC,QAAf,uBACE,mBAAIF,IAAI,CAACI,IAAT,EADF,EAbF,cAgBE,aAAK,SAAS,CAAC,QAAf,WACGJ,IAAI,CAACjB,GADR,QACiBiB,IAAI,CAAChB,KADtB,QACiCgB,IAAI,CAACjB,GAAL,CAAWiB,IAAI,CAAChB,KADjD,GAhBF,GADF,EAASgB,IAAI,CAACG,OAAd,CADkB,EAAnB,CADH,EAFF,GADF,EApBF,GADF,EADF,cAuDE,YAAK,SAAS,CAAC,OAAf,uBACE,YAAK,SAAS,CAAC,gBAAf,uBACE,mCACE,iCACE,qCADF,EADF,cAIE,iCACE,aAAK,SAAS,CAAC,KAAf,wBACE,8BADF,cAEE,2BAAOvC,IAAI,CAACc,UAAL,CAAgBD,OAAhB,CAAwB,CAAxB,CAAP,GAFF,GADF,EAJF,cAUE,iCACE,aAAK,SAAS,CAAC,KAAf,wBACE,iCADF,cAEE,2BAAOb,IAAI,CAACqB,aAAL,CAAmBR,OAAnB,CAA2B,CAA3B,CAAP,GAFF,GADF,EAVF,cAgBE,iCACE,aAAK,SAAS,CAAC,KAAf,wBACE,4BADF,cAEE,2BAAOb,IAAI,CAACsB,QAAL,CAAcT,OAAd,CAAsB,CAAtB,CAAP,GAFF,GADF,EAhBF,cAsBE,iCACE,aAAK,SAAS,CAAC,KAAf,wBACE,kCACE,wCADF,EADF,cAIE,kCACE,8BAAUb,IAAI,CAACuB,UAAL,CAAgBV,OAAhB,CAAwB,CAAxB,CAAV,GADF,EAJF,GADF,EAtBF,cAgCE,iCACE,eACE,IAAI,CAAC,QADP,CAEE,OAAO,CAAEY,iBAFX,CAGE,SAAS,CAAC,eAHZ,CAIE,QAAQ,CAAEzB,IAAI,CAACe,SAAL,CAAe0B,MAAf,GAA0B,CAJtC,yBADF,EAhCF,CA0CGnC,OAAO,eAAI,KAAC,UAAD,IA1Cd,CA2CGE,KAAK,eAAI,KAAC,UAAD,EAAY,OAAO,CAAC,QAApB,UAA8BA,KAA9B,EA3CZ,GADF,EADF,EAvDF,GAFF,GADF,CA8GD","sourcesContent":["import React, { useEffect } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { Link } from 'react-router-dom';\r\nimport { createOrder } from '../actions/orderActions';\r\nimport CheckoutSteps from '../components/CheckoutSteps';\r\nimport { ORDER_CREATE_RESET } from '../constants/orderConstants';\r\nimport LoadingBox from '../components/LoadingBox';\r\nimport MessageBox from '../components/MessageBox';\r\n\r\nexport default function PlaceOrderScreen(props) {\r\n  const cart = useSelector((state) => state.cart);\r\n  if (!cart.paymentMethod) {\r\n    props.history.push('/payment');\r\n  }\r\n  const orderCreate = useSelector((state) => state.orderCreate);\r\n  const { loading, success, error, order } = orderCreate;\r\n  const toPrice = (num) => Number(num.toFixed(2)); // 5.123 => \"5.12\" => 5.12\r\n  cart.itemsPrice = toPrice(\r\n    cart.cartItems.reduce((a, c) => a + c.qty * c.price, 0)\r\n  );\r\n  cart.shippingPrice = cart.itemsPrice > 100 ? toPrice(0) : toPrice(10);\r\n  cart.taxPrice = toPrice(0.15 * cart.itemsPrice);\r\n  cart.totalPrice = cart.itemsPrice + cart.shippingPrice + cart.taxPrice;\r\n  const dispatch = useDispatch();\r\n  const placeOrderHandler = () => {\r\n    // TODO: dispatch place order action\r\n    \r\n    dispatch(createOrder({ ...cart, orderItems: cart.cartItems }));\r\n  };\r\n  useEffect(() => {\r\n    // console.log(cart.cartItems);\r\n    if (success) {\r\n      props.history.push(`/order/${order._id}`);\r\n      dispatch({ type: ORDER_CREATE_RESET });\r\n    }\r\n  }, [dispatch, order, props.history, success]);\r\n  return (\r\n    <div>\r\n      <CheckoutSteps step1 step2 step3 step4></CheckoutSteps>\r\n      <div className=\"row top\">\r\n        <div className=\"col-2\">\r\n          <ul>\r\n            <li>\r\n              <div className=\"card card-body\">\r\n                <h2>Shipping</h2>\r\n                <p>\r\n                  <strong>Name:</strong> {cart.shippingAddress.fullName} <br />\r\n                  <strong>Address: </strong> {cart.shippingAddress.address},\r\n                  {cart.shippingAddress.city}, {cart.shippingAddress.postalCode}\r\n                  ,{cart.shippingAddress.country}\r\n                </p>\r\n              </div>\r\n            </li>\r\n            <li>\r\n              <div className=\"card card-body\">\r\n                <h2>Payment</h2>\r\n                <p>\r\n                  <strong>Method:</strong> {cart.paymentMethod}\r\n                </p>\r\n              </div>\r\n            </li>\r\n            <li>\r\n              <div className=\"card card-body\">\r\n                <h2>Order Items</h2>\r\n                <ul>\r\n                  {cart.cartItems.map((item) => (\r\n                    <li key={item.product}>\r\n                      <div className=\"row\">\r\n                        <div className=\"min-30\">\r\n                          <img\r\n                            src={item.image}\r\n                            alt={item.name}\r\n                            className=\"small\"\r\n                          ></img>\r\n                        </div>\r\n                        <div className=\"min-30\">\r\n                          <Link to={`/product/${item.product}`}>\r\n                            {item.name}\r\n                          </Link>\r\n                        </div>\r\n                        <div className=\"min-30\">\r\n                          <p>{item.size}</p>\r\n                        </div>\r\n                        <div className=\"min-30\">\r\n                          {item.qty} x ${item.price} = ${item.qty * item.price}\r\n                        </div>\r\n                      </div>\r\n                    </li>\r\n                  ))}\r\n                </ul>\r\n              </div>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n        <div className=\"col-1\">\r\n          <div className=\"card card-body\">\r\n            <ul>\r\n              <li>\r\n                <h2>Order Summary</h2>\r\n              </li>\r\n              <li>\r\n                <div className=\"row\">\r\n                  <div>Items</div>\r\n                  <div>${cart.itemsPrice.toFixed(2)}</div>\r\n                </div>\r\n              </li>\r\n              <li>\r\n                <div className=\"row\">\r\n                  <div>Shipping</div>\r\n                  <div>${cart.shippingPrice.toFixed(2)}</div>\r\n                </div>\r\n              </li>\r\n              <li>\r\n                <div className=\"row\">\r\n                  <div>Tax</div>\r\n                  <div>${cart.taxPrice.toFixed(2)}</div>\r\n                </div>\r\n              </li>\r\n              <li>\r\n                <div className=\"row\">\r\n                  <div>\r\n                    <strong> Order Total</strong>\r\n                  </div>\r\n                  <div>\r\n                    <strong>${cart.totalPrice.toFixed(2)}</strong>\r\n                  </div>\r\n                </div>\r\n              </li>\r\n              <li>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={placeOrderHandler}\r\n                  className=\"primary block\"\r\n                  disabled={cart.cartItems.length === 0}\r\n                >\r\n                  Place Order\r\n                </button>\r\n              </li>\r\n              {loading && <LoadingBox></LoadingBox>}\r\n              {error && <MessageBox variant=\"danger\">{error}</MessageBox>}\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}"]},"metadata":{},"sourceType":"module"}